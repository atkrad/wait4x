on: [push, pull_request]
name: Wait4X CI
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
    - name: Use Golang 1.17.x
      uses: actions/setup-go@v3
      with:
        go-version: 1.17.x

    - uses: actions/checkout@v3

    - name: go-fmt
      run: make check-gofmt

    - name: go-vet
      run: go vet ./...

    - name: revive
      run: |
        go install github.com/mgechev/revive@v1.1.2
        make check-revive

  test:
    needs: check
    strategy:
      matrix:
        go-version: [1.16.x, 1.17.x, 1.18.x]
    runs-on: ubuntu-latest
    steps:
    - uses: actions/setup-go@v3
      with:
        go-version: ${{ matrix.go-version }}
    - uses: actions/checkout@v3
    - run: make test

#   coverage:
#     needs: test
#     runs-on: ubuntu-latest
#     steps:
#     - name: Coveralls Finished
#       uses: coverallsapp/github-action@master
#       with:
#         github-token: ${{ secrets.github_token }}
#         parallel-finished: true